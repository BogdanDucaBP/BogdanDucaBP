<html>
<head>
    <title>Test Reports</title>
</head>
<body>
    <h1>Welcome to Test Reports</h1>
    <div id="reports-container">
        <p>Loading test reports...</p>
    </div>

    <script>
    async function testFetchSingleReport() {
        const reportsContainer = document.getElementById('reports-container');
        reportsContainer.innerHTML = '';

        try {
            const response = await fetch('reports/ManuallyRun_ISCSchedule.xml');
            if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);

            const xmlText = await response.text();
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xmlText, 'text/xml');

            displayXml(xmlDoc, "ManuallyRun_ISCSchedule.xml", reportsContainer);
        } catch (error) {
            console.error("Error fetching the report file:", error);
            reportsContainer.innerHTML = `<p>Error fetching the report file: ${error.message}</p>`;
        }
    }

    function displayXml(xmlDoc, headingText, reportsContainer) {
        console.log("displayXml called with:", xmlDoc, headingText); // Debugging
        const testSuites = xmlDoc.querySelectorAll('testsuite');
        
        if (testSuites.length > 0) {
            const reportHeading = document.createElement('h2');
            reportHeading.textContent = headingText;
            reportsContainer.appendChild(reportHeading);
        }
        
        testSuites.forEach(suite => {
            const suiteName = suite.getAttribute('name');
            const suiteElement = document.createElement('p');
            suiteElement.textContent = `Test Suite: ${suiteName}`;
            reportsContainer.appendChild(suiteElement);

            const testCases = suite.querySelectorAll('testcase');
            testCases.forEach(testCase => {
                const caseName = testCase.getAttribute('name');
                const caseElement = document.createElement('p');
                caseElement.textContent = `  - Test Case: ${caseName}`;
                reportsContainer.appendChild(caseElement);
            });
        });
    }

    testFetchSingleReport();
</script>
</body>
</html>
